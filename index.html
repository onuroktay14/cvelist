<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Canlƒ± CVE ve Exploit Takip Paneli</title>
    <style>
        :root { --danger: #e74c3c; --warning: #f1c40f; --exploit: #8e44ad; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; }
        .cve-card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-left: 8px solid #cbd5e0; position: relative; }
        .exploit-badge { 
            position: absolute; top: -10px; right: 10px; 
            background: var(--exploit); color: white; padding: 5px 15px; 
            border-radius: 20px; font-weight: bold; font-size: 0.8rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        .cve-id { font-size: 1.4rem; font-weight: 800; color: #2c3e50; text-decoration: none; }
        .score-badge { padding: 5px 10px; border-radius: 5px; font-weight: bold; margin-left: 10px; }
        .high { background: var(--danger); color: white; }
        .desc { background: #f8fafc; padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #edf2f7; }
        .cwe-tag { font-size: 0.75rem; background: #e2e8f0; padding: 3px 8px; border-radius: 4px; margin-right: 5px; text-decoration: none; color: #4a5568; }
    </style>
</head>
<body>

<div style="max-width: 900px; margin: auto;">
    <h1 style="text-align:center;">Canlƒ± CVE & Exploit Takibi</h1>
    <div id="cve-list">Y√ºkleniyor...</div>
</div>

<script>
    async function fetchAll() {
        const container = document.getElementById('cve-list');
        try {
            const res = await fetch('./data.json?t=' + Date.now());
            const data = await res.json();
            container.innerHTML = '';

            data.forEach(item => {
                const cveId = item.cveMetadata?.cveId || "Bilinmiyor";
                
                // CVSS PUANI BULMA (Geli≈ümi≈ü Arama)
                let score = 0;
                // √ñnce CNA verisine bak
                const cnaMetrics = item.containers?.cna?.metrics || [];
                // Sonra varsa ADP (ek veri) kƒ±smƒ±na bak
                const adpMetrics = item.containers?.adp?.[0]?.metrics || [];
                const allMetrics = [...cnaMetrics, ...adpMetrics];
                
                allMetrics.forEach(m => {
                    const s = m.cvssV3_1?.baseScore || m.cvssV3_0?.baseScore || m.cvssV2?.baseScore;
                    if (s > score) score = s;
                });

                // Exploit Durumu (Python script'imizden geliyor)
                const isExploited = item.is_exploited || false;

                const card = document.createElement('div');
                card.className = 'cve-card';
                if (score >= 7) card.style.borderColor = 'var(--danger)';
                
                card.innerHTML = `
                    ${isExploited ? '<div class="exploit-badge">‚ö†Ô∏è AKTƒ∞F EXPLOIT EDƒ∞Lƒ∞YOR</div>' : ''}
                    <div style="display:flex; align-items:center;">
                        <a href="https://nvd.nist.gov/vuln/detail/${cveId}" target="_blank" class="cve-id">${cveId}</a>
                        <span class="score-badge ${score >= 7 ? 'high' : ''}">CVSS: ${score > 0 ? score : 'N/A'}</span>
                    </div>
                    <div class="desc">${item.containers?.cna?.descriptions?.[0]?.value || 'A√ßƒ±klama yok.'}</div>
                    <div style="margin-top:10px;">
                        <a href="https://www.google.com/search?q=${cveId}+exploit+github+poc" target="_blank" style="font-size:0.8rem; color:var(--exploit); font-weight:bold;">[ PoC Ara üîç ]</a>
                    </div>
                `;
                container.appendChild(card);
            });
        } catch (e) { container.innerText = "Hata olu≈ütu."; }
    }
    fetchAll();
</script>
</body>
</html>
