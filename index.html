<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI CVE Intelligence Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --bg: #020617; --glass: rgba(30, 41, 59, 0.7); --neon: #38bdf8; }
        body { background: var(--bg); color: #cbd5e1; font-family: 'Inter', sans-serif; }
        .info-panel { background: rgba(15, 23, 42, 0.8); border-left: 4px solid var(--neon); border-radius: 12px; }
        .stat-card { background: var(--glass); border: 1px solid rgba(255,255,255,0.05); border-radius: 16px; backdrop-filter: blur(10px); }
        .search-box { background: rgba(255,255,255,0.05); border: 1px solid rgba(56,189,248,0.2); color: white; border-radius: 10px; padding: 10px 20px; width: 100%; }
        .search-box:focus { background: rgba(255,255,255,0.1); border-color: var(--neon); color: white; outline: none; box-shadow: 0 0 15px rgba(56,189,248,0.2); }
        .table tr { background: rgba(30, 41, 59, 0.4); transition: 0.3s; }
        .table tr:hover { background: rgba(56,189,248,0.1); transform: scale(1.01); }
        .badge-mitre { background: rgba(168, 85, 247, 0.2); color: #a855f7; border: 1px solid #a855f7; cursor: pointer; }
        .ai-btn { background: linear-gradient(135deg, #6366f1, #a855f7); border: none; color: white; border-radius: 8px; font-weight: 600; }
        footer a { color: var(--neon); text-decoration: none; text-shadow: 0 0 5px var(--neon); }
    </style>
</head>
<body>

<div class="container py-5">
    <div class="info-panel p-4 mb-4 shadow-lg">
        <h5 class="fw-bold text-info mb-2"><i class="fas fa-shield-halved me-2"></i>Mission Briefing</h5>
        <p class="mb-0 small opacity-80">
            This platform lists vulnerabilities (CVE) actively exploited by <b>Hackers</b>. 
            It determines the <b>EPSS</b> (Exploit Prediction) and priority for specific <b>Vendors</b> and <b>Products</b>.
        </p>
    </div>

    <div class="row g-4 mb-4">
        <div class="col-md-3"><div class="stat-card p-4"><h6>TOTAL RECORDS</h6><h2 id="totalCount">0</h2></div></div>
        <div class="col-md-3"><div class="stat-card p-4 text-danger"><h6>CRITICAL (P0)</h6><h2 id="criticalCount">0</h2></div></div>
        <div class="col-md-3"><div class="stat-card p-4 text-warning"><h6>HIGH RISK (>80%)</h6><h2 id="epssCount">0</h2></div></div>
        <div class="col-md-3"><div class="stat-card p-4 text-info"><h6>ACTIVE EXPLOITS</h6><h2 id="exploitCount">0</h2></div></div>
    </div>

    <div class="p-4" style="background: rgba(15,23,42,0.4); border-radius: 20px; border: 1px solid rgba(255,255,255,0.05);">
        <div class="row mb-4 align-items-center">
            <div class="col-md-6"><h4 class="fw-bold mb-0"><i class="fas fa-terminal me-2 text-info"></i>Threat Stream</h4></div>
            <div class="col-md-6">
                <input type="text" id="searchInput" class="search-box" placeholder="Search by Vendor, Product or CVE (e.g: Windows, Cisco)..." onkeyup="filterTable()">
            </div>
        </div>

        <div class="table-responsive">
            <table class="table align-middle text-white" style="border-collapse: separate; border-spacing: 0 8px;">
                <thead>
                    <tr class="text-info small">
                        <th>CVE / VENDOR</th>
                        <th>PRIORITY</th>
                        <th>METRICS</th>
                        <th>MITRE ATT&CK</th>
                        <th class="text-end">ACTIONS</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<footer class="text-center pb-5">
    <p class="small opacity-50">Architected by <a href="https://www.linkedin.com/in/onuroktaycom/" target="_blank">Onur Oktay</a></p>
</footer>

<div class="modal fade" id="aiModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content bg-dark border-info">
            <div class="modal-header border-0"><h5 class="modal-title text-info"><i class="fas fa-robot me-2"></i>AI Remediation Engine</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <h6 id="mCve" class="text-danger fw-bold"></h6>
                <p id="mDesc" class="small opacity-75"></p>
                <hr class="border-secondary">
                <div class="fw-bold text-success mb-2">ACTIONS:</div>
                <ul id="mSteps" class="small"></ul>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    let rawData = [];
    async function init() {
        const res = await fetch('data.json?v=' + Date.now());
        rawData = await res.json();
        renderTable(rawData);
    }

    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        document.getElementById('totalCount').innerText = data.length;
        document.getElementById('criticalCount').innerText = data.filter(d => d.priority.includes('P0')).length;
        document.getElementById('epssCount').innerText = data.filter(d => parseInt(d.epss) > 80).length;
        document.getElementById('exploitCount').innerText = data.length;

        data.forEach(item => {
            const pClass = item.priority.split(' ')[0];
            tbody.innerHTML += `
                <tr>
                    <td>
                        <div class="fw-bold">${item.id}</div>
                        <span class="badge bg-secondary small" style="font-size:10px">${item.vendor}</span>
                        <span class="text-info small ms-1" style="font-size:10px">${item.product}</span>
                    </td>
                    <td><span class="badge border border-${pClass === 'P0' ? 'danger' : 'warning'} text-white w-100 p-2">${item.priority}</span></td>
                    <td>
                        <div class="small">CVSS: <b>${item.severity}</b></div>
                        <div class="text-warning" style="font-size:11px">EPSS: ${item.epss}</div>
                    </td>
                    <td><span class="badge badge-mitre" onclick="window.open('https://attack.mitre.org/techniques/${item.mitre}/')">${item.mitre}</span></td>
                    <td class="text-end">
                        <button class="btn btn-sm ai-btn mb-1 w-100" onclick="showAI('${item.id}','${item.vendor}','${item.product}')">AI ANALYZE</button>
                        <a href="${item.poc_link}" target="_blank" class="btn btn-sm btn-outline-light w-100" style="font-size:10px">Github/PoC</a>
                    </td>
                </tr>`;
        });
    }

    function filterTable() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const filtered = rawData.filter(d => 
            d.vendor.toLowerCase().includes(query) || 
            d.product.toLowerCase().includes(query) || 
            d.id.toLowerCase().includes(query)
        );
        renderTable(filtered);
    }

    function showAI(cve, v, p) {
        document.getElementById('mCve').innerText = cve;
        document.getElementById('mDesc').innerText = `Security analysis for ${v} ${p}.`;
        const steps = [`Apply latest ${v} patch immediately.`, "Monitor EDR logs for IOCs.", "Restrict network access to affected ports."];
        document.getElementById('mSteps').innerHTML = steps.map(s => `<li>${s}</li>`).join('');
        new bootstrap.Modal(document.getElementById('aiModal')).show();
    }
    init();
</script>
</body>
</html>
